<div class="wrap">

  <div class="top">
    <div>
      <h1 class="h1">Products</h1>
      <div class="muted">Browse products and add them to your cart.</div>
    </div>
  </div>

  <div class="filters">
    <input class="ms-input" type="text" placeholder="Search" [(ngModel)]="search" (ngModelChange)="applyFilters()">
    <select class="ms-input" [(ngModel)]="category" (ngModelChange)="applyFilters()">
      <option value="">All categories</option>
      <option *ngFor="let c of categories" [value]="c">{{c}}</option>
    </select>
  </div>

  <div class="grid">
    <div class="card" *ngFor="let p of products">
      <a class="media" [routerLink]="['/products', p.id]">
        <img class="img" [src]="p.imageUrl" [alt]="p.name" loading="lazy" />
        <div class="badge" *ngIf="badgeText(p) as b">{{b}}</div>
      </a>

      <div class="card-body">
        <div class="meta">
          <span class="vendor">{{p.vendor}}</span>
          <span class="dot">•</span>
          <span class="category">{{p.category}}</span>
        </div>

        <a class="name name-link" [routerLink]="['/products', p.id]" [title]="p.name">{{p.name}}</a>

        <div class="price-row">
          <span class="price">€{{p.price | number:'1.2-2'}}</span>
          <span class="original" *ngIf="originalPrice(p) as op">€{{op | number:'1.2-2'}}</span>
          <span class="period" *ngIf="p.isSubscription">{{p.billingPeriod}}</span>
        </div>
      </div>

      <div class="card-footer">
        <div class="qty">
          <input
            class="qty-input"
            type="number"
            min="1"
            [max]="p.stock"
            [(ngModel)]="qty[p.id]" />
        </div>

        <button class="ms-btn primary" (click)="add(p)">Add</button>
      </div>
    </div>
  </div>
</div>
